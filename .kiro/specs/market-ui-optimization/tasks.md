# Market 页面 UI 优化实现计划

- [x] 1. TopAppBar 重复图标问题修复

  - 修改 MarketScreen.kt 中的 TopAppBar 配置，移除重复的搜索图标
  - 保留真正的搜索功能图标，移除"Test API"功能的搜索图标
  - 将 API 测试功能移至开发者选项或通过长按手势触发
  - 确保 TopAppBar 保持 Instagram 风格的简洁设计
  - _需求: 1.1, 1.2, 1.3, 1.4_

- [x] 2. 创建居中对齐的排序徽章组件

  - 创建新的 CenteredRankingBadge 组件，解决数字居中对齐问题
  - 实现动态宽度调整，根据数字位数自动调整容器宽度
  - 使用 Box + Alignment.Center 确保数字完美居中显示
  - 添加统一的圆角和颜色主题，保持视觉一致性
  - 处理个位数、两位数、三位数等不同情况的显示效果
  - _需求: 3.1, 3.2, 3.3, 3.4, 3.5_

- [x] 3. 重构 MarketCoinListItem 布局结构

  - 重新设计 MarketCoinListItem 的内部布局，解决字符串过长导致的 UI 不协调问题
  - 实现信息层次化布局：主要信息(名称+价格)和次要信息(符号+涨跌幅)分行显示
  - 优化空间分配，使用 weight 和 Spacer 合理分配水平空间
  - 实现智能文本截断，确保长币种名称不影响整体布局
  - 统一价格信息右对齐，涨跌幅使用一致的背景样式
  - _需求: 2.1, 2.2, 2.3, 2.4, 2.5_

- [x] 4. 实现响应式布局和文本处理优化

  - 添加屏幕尺寸适配逻辑，在紧凑屏幕上调整布局密度
  - 创建文本处理扩展函数，实现智能文本截断和格式化
  - 实现预计算文本宽度机制，避免布局抖动
  - 添加市值信息的条件显示逻辑，在空间不足时隐藏次要信息
  - 优化不同屏幕尺寸下的字体大小和间距
  - _需求: 2.6, 4.3, 5.3_

- [x] 5. 性能优化和动画效果实现

  - 使用 remember 缓存格式化结果，避免重复计算
  - 实现布局变化的平滑动画效果
  - 优化价格变化时的颜色动画，保持流畅的视觉反馈
  - 添加 CompositionLocal 优化数据传递，减少 prop drilling
  - 实现骨架屏处理数据加载状态，提升用户体验
  - _需求: 5.1, 5.2, 5.4, 4.4_

- [x] 6. 主题系统和样式统一

  - 扩展 InstagramColors 色彩系统，添加排序徽章和市值信息专用颜色
  - 创建统一的间距系统 MarketListSpacing，确保视觉一致性
  - 优化暗黑模式下的显示效果，保持 Instagram 风格
  - 实现主题切换时的平滑过渡动画
  - 确保所有 UI 组件在不同主题下的一致性表现
  - _需求: 4.1, 4.2, 4.4_

- [x] 7. 错误处理和边界情况完善

  - 实现 SafeMarketCoinListItem 组件，处理数据异常情况
  - 添加空数据字段的安全处理逻辑
  - 实现智能文本截断算法，优先在合适位置截断
  - 添加网络异常时的占位符显示
  - 处理极端长度文本和特殊字符的显示问题
  - _需求: 5.5, 2.1, 2.2_

- [x] 8. 全面测试和质量保证

  - 编写 UI 测试验证排序数字居中效果和不同位数显示
  - 测试长币种名称的截断和布局稳定性
  - 验证不同屏幕尺寸下的响应式布局效果
  - 测试暗黑模式切换的视觉效果和动画
  - 进行性能测试，确保列表滚动流畅度不受影响
  - _需求: 所有需求的质量验证_

- [x] 9. 最终集成和用户体验验证

  - 集成所有优化组件，确保整体协调性
  - 进行端到端的用户体验测试
  - 验证 Instagram 风格设计的一致性
  - 确认所有 UI 问题得到有效解决
  - 进行最终的性能和内存使用优化
  - _需求: 4.1, 4.2, 4.3, 4.4, 4.5_
